---
output: html_notebook
---

<br>
<b><center><h1> Statistics Project II </h1></center></b>
<center><h3>by Sam Sharp, Alvin Ugochukwu, and Jon Scheaffer</h3></center>
<br>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;World Happiness Score is obtained by statistically calculating many different variables which describe aspects of society in a given country. These variables are GDP, social support, health/life expectancy, freedom, generosity, and perceptions of corruption. The dataset used is from Kaggle (https://www.kaggle.com/datasets/ajaypalsinghlo/world-happiness-report-2022) and uses data from the World Gallup Poll. Importantly, none of the predictor variables appear to be colinear, which strengthens the argument for the use of multiple linear regression. The dataset consists of entries for 146 countries, using 6 predictors that each linearly correlate with the World Happiness Score.</p>
<br>


```{r, echo=FALSE}
library(MASS) 
library(reshape2) 
library(reshape)
library(plotly)
library(car)
```

```{r, echo=FALSE}
data <- read.csv("Resources/World Happiness Report 2022.csv")
head(data)
```
<p>Above:The first six rows of a table displaying the data in the World Happienes report.</p>
------------------------------------------------------
<br>

```{r, echo=FALSE}
hs = data$Happiness.score
dys_r = data$Dystopia..1.83....residual
gdp = data$Explained.by..GDP.per.capita
soc = data$Explained.by..Social.support
hle = data$Explained.by..Healthy.life.expectancy
free = data$Explained.by..Freedom.to.make.life.choices
gene = data$Explained.by..Generosity
poc = data$Explained.by..Perceptions.of.corruption
df <- data.frame(hs, dys_r, soc, gdp, hle, free, gene, poc)
```

```{r, echo=FALSE, results='hide'}
summary(df)
```

```{r, echo=FALSE, results='hide'}
str(df)
```
<center><h2> Scatter Plots between the Different Variables </h2></center>
<br>
```{r, echo=FALSE}
par(mfrow = c(1,3))
plot(hs, soc, pch = 19, col = "black")
plot(hs, gdp, pch = 19, col = "black")
plot(hs, hle, pch = 19, col = "black")
plot(hs, free, pch = 19, col = "black")
plot(hs, gene, pch = 19, col = "black")
plot(hs, poc, pch = 19, col = "black")
```



```{r, echo=FALSE}
model <- lm(hs ~ dys_r + gdp + hle + free + gene+poc)
summary(model)
```

```{r, echo=FALSE, results='hide'}
cormat <- round(cor(df),2)
melted_format <- melt(cormat)
```

```{r, echo=FALSE}
ggplot(data = melted_format, aes(x=X1, y=X2, fill=value )) + 
  geom_tile() + geom_text(aes(label = value), color = 'white')
ggsave('Correlation_heatmap.png', width = 5, height = 5)
```


```{r, echo=FALSE}
model <- lm(hs ~ gdp + hle + free + gene+poc)
summary(model)
```

```{r, echo=FALSE, results='hide'}
vif(model)
```

```{r, echo=FALSE}
vif_values <- vif(model)
barplot(vif_values, main = "VIF Values", horiz = TRUE, col = "steelblue")
```



