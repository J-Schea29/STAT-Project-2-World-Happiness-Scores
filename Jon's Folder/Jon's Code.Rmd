---
output: html_notebook
---

<br>
<b><center><h1> Statistics Project II </h1></center></b>
<center><h3>by Sam Sharp, Alvin Ugochukwu, and Jon Scheaffer</h3></center>
<br>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;World Happiness Score is obtained by statistically calculating many different variables which describe aspects of society in a given country. These variables are GDP, social support, health/life expectancy, freedom, genoerosity, and perceptions of corruption. The dataset used is from the World Gallup Poll. Importantly, none of the predictor variables appear to be colinear, which strengthens the argument for the use of multiple linear regression. The dataset consists of entries for 146 countries, using 6 predictors that each linearly correlate with the World Happiness Score.</p>
<br>


```{r, echo=FALSE}
library(MASS) 
library(reshape2) 
library(reshape)
library(plotly)
library(car)
```

```{r, echo=FALSE}
data <- read.csv("Resources/World Happiness Report 2022.csv")
data
```
```{r, echo=FALSE}
hs = data$Happiness.score
dys_r = data$Dystopia..1.83....residual
gdp = data$Explained.by..GDP.per.capita
soc = data$Explained.by..Social.support
hle = data$Explained.by..Healthy.life.expectancy
free = data$Explained.by..Freedom.to.make.life.choices
gene = data$Explained.by..Generosity
poc = data$Explained.by..Perceptions.of.corruption
df <- data.frame(hs, dys_r, soc, gdp, hle, free, gene, poc)
```

```{r, echo=FALSE}
summary(df)
```

```{r, echo=FALSE}
str(df)
```

```{r}
plot(hs, dys_r, pch = 19, col = "black")
plot(hs, soc, pch = 19, col = "black")
plot(hs, gdp, pch = 19, col = "black")
plot(hs, hle, pch = 19, col = "black")
plot(hs, free, pch = 19, col = "black")
plot(hs, gene, pch = 19, col = "black")
plot(hs, poc, pch = 19, col = "black")
```


```{r, echo=FALSE}
model <- lm(hs ~ dys_r + gdp + hle + free + gene+poc)
summary(model)
```

```{r, echo=FALSE}
cormat <- round(cor(df),2)
melted_format <- melt(cormat)
```

```{r, echo=FALSE}
ggplot(data = melted_format, aes(x=X1, y=X2, fill=value )) + 
  geom_tile() + geom_text(aes(label = value), color = 'white')
ggsave('Correlation_heatmap.png', width = 5, height = 5)
```


```{r, echo=FALSE}
model <- lm(hs ~ gdp + hle + free + gene+poc)
summary(model)
```

```{r, echo=FALSE}
vif(model)
```

```{r, echo=FALSE}
vif_values <- vif(model)
barplot(vif_values, main = "VIF Values", horiz = TRUE, col = "steelblue")
```
```
```{r}

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
